define("text",["module"],function(t){"use strict";function e(t,e){return void 0===t||""===t?e:t}function n(t,n,a,i){if(n===i)return!0;if(t===a){if("http"===t)return e(n,"80")===e(i,"80");if("https"===t)return e(n,"443")===e(i,"443")}return!1}var a,i,s,o,l,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],d=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,h=u&&location.protocol&&location.protocol.replace(/\:/,""),p=u&&location.hostname,m=u&&(location.port||void 0),f={},g=t.config&&t.config()||{};return a={version:"2.0.15",strip:function(t){if(t){t=t.replace(d,"");var e=t.match(c);e&&(t=e[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:g.createXhr||function(){var t,e,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){n=r[e];try{t=new ActiveXObject(n)}catch(t){}if(t){r=[n];break}}return t},parseName:function(t){var e,n,a,i=!1,s=t.lastIndexOf("."),o=0===t.indexOf("./")||0===t.indexOf("../");return s!==-1&&(!o||s>1)?(e=t.substring(0,s),n=t.substring(s+1)):e=t,a=n||e,s=a.indexOf("!"),s!==-1&&(i="strip"===a.substring(s+1),a=a.substring(0,s),n?n=a:e=a),{moduleName:e,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,e,i,s){var o,l,r,d=a.xdRegExp.exec(t);return!d||(o=d[2],l=d[3],l=l.split(":"),r=l[1],l=l[0],(!o||o===e)&&(!l||l.toLowerCase()===i.toLowerCase())&&(!r&&!l||n(o,r,e,s)))},finishLoad:function(t,e,n,i){n=e?a.strip(n):n,g.isBuild&&(f[t]=n),i(n)},load:function(t,e,n,i){if(i&&i.isBuild&&!i.inlineText)return void n();g.isBuild=i&&i.isBuild;var s=a.parseName(t),o=s.moduleName+(s.ext?"."+s.ext:""),l=e.toUrl(o),r=g.useXhr||a.useXhr;return 0===l.indexOf("empty:")?void n():void(!u||r(l,h,p,m)?a.get(l,function(e){a.finishLoad(t,s.strip,e,n)},function(t){n.error&&n.error(t)}):e([o],function(t){a.finishLoad(s.moduleName+"."+s.ext,s.strip,t,n)}))},write:function(t,e,n,i){if(f.hasOwnProperty(e)){var s=a.jsEscape(f[e]);n.asModule(t+"!"+e,"define(function () { return '"+s+"';});\n")}},writeFile:function(t,e,n,i,s){var o=a.parseName(e),l=o.ext?"."+o.ext:"",r=o.moduleName+l,d=n.toUrl(o.moduleName+l)+".js";a.load(r,n,function(e){var n=function(t){return i(d,t)};n.asModule=function(t,e){return i.asModule(t,d,e)},a.write(t,r,n,s)},s)}},"node"===g.env||!g.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(i=require.nodeRequire("fs"),a.get=function(t,e,n){try{var a=i.readFileSync(t,"utf8");"\ufeff"===a[0]&&(a=a.substring(1)),e(a)}catch(t){n&&n(t)}}):"xhr"===g.env||!g.env&&a.createXhr()?a.get=function(t,e,n,i){var s,o=a.createXhr();if(o.open("GET",t,!0),i)for(s in i)i.hasOwnProperty(s)&&o.setRequestHeader(s.toLowerCase(),i[s]);g.onXhr&&g.onXhr(o,t),o.onreadystatechange=function(a){var i,s;4===o.readyState&&(i=o.status||0,i>399&&i<600?(s=new Error(t+" HTTP status: "+i),s.xhr=o,n&&n(s)):e(o.responseText),g.onXhrComplete&&g.onXhrComplete(o,t))},o.send(null)}:"rhino"===g.env||!g.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?a.get=function(t,e){var n,a,i="utf-8",s=new java.io.File(t),o=java.lang.System.getProperty("line.separator"),l=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),r="";try{for(n=new java.lang.StringBuffer,a=l.readLine(),a&&a.length()&&65279===a.charAt(0)&&(a=a.substring(1)),null!==a&&n.append(a);null!==(a=l.readLine());)n.append(o),n.append(a);r=String(n.toString())}finally{l.close()}e(r)}:("xpconnect"===g.env||!g.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(s=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),l="@mozilla.org/windows-registry-key;1"in s,a.get=function(t,e){var n,a,i,r={};l&&(t=t.replace(/\//g,"\\")),i=new FileUtils.File(t);try{n=s["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),n.init(i,1,0,!1),a=s["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),a.init(n,"utf-8",n.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),r),a.close(),n.close(),e(r.value)}catch(t){throw new Error((i&&i.path||"")+": "+t)}}),a}),define("text!tpl/login.html",[],function(){return'<div style="background-color:#ffffff;margin-bottom:5px;padding:20px 0;text-align:center">\n    <h3>KT 멤버십 통계</h3>\n</div>\n<div style="background-color:#ffffff;padding:20px">\n  <div style="text-align:center">\n    <p>로그인이 필요한 서비스 입니다.</p>\n    <p>아이디와 비밀번호를 입력하여 주십시오</p>\n  </div>\n    <form class="form-horizontal">\n        <div class="form-group _login_bidder">\n            <label for="inputEmail3" class="col-md-3 control-label"><i class="fa fa-user"></i> ID :</label>\n            <div class="col-md-9">\n                <input type="text" id="kt_login_insert_id" class="form-control" placeholder="아이디">\n            </div>\n        </div>\n\n        <div class="form-group _login_password">\n            <label for="inputPassword3" class="col-sm-3 control-label"><i class="fa fa-lock"></i> 비밀번호 :</label>\n            <div class="col-sm-9">\n                <input type="password" id="kt_login_pwd" class="form-control" placeholder="비밀번호">\n            </div>\n        </div>\n\n        <div class="row">\n            <div class="col-md-12">\n                <button id="kt_login_submit" class="btn btn-primary btn-block btn-flat _login_btn"><i class="fa fa-sign-in"></i><strong> 로그인</strong></button>\n            </div>\n        </div>\n    </form>\n    <footer class="main-footer">\n\n    </footer>\n</div>\n\n<!-- <div style="background-color:#ffffff;margin-top:5px;padding:20px 0;text-align:center">\n    <div style="text-align:center">\n        <div><strong>등록신청은 hellopix@sqisoft.com</div>\n    </div>\n</div> -->\n'}),define("Model",["require","exports","module"],function(t,e,n){function a(t){$.ajax(t)}n.exports=new(Backbone.Model.extend({postLogin:a,getUser:function(t){var e=store.get("auth").token;$.ajax({url:KT.HOST+"/info/membership/"+t.pathDateOption+"/visit",data:{from:t.fromDate,to:t.toDate},method:"GET",headers:{"x-auth-token":e},dataType:"json",contentType:"application/json; charset=UTF-8",success:t.success,error:t.error})},getMenu:function(t){var e=store.get("auth").token;$.ajax({url:KT.HOST+"/info/membership/menu",data:{from:t.fromDate,to:t.toDate},method:"GET",headers:{"x-auth-token":e},dataType:"json",contentType:"application/json; charset=UTF-8",success:t.success,error:t.error})},getToken:function(){return store.get("auth").token},getAction:function(t){var e=store.get("auth").token;$.ajax({url:KT.HOST+"/info/service/membership/action",data:{from:t.fromDate,to:t.toDate,action:t.action},method:"GET",headers:{"x-auth-token":e},dataType:"json",contentType:"application/json; charset=UTF-8",success:t.success,error:t.error})},getActionName:function(t){var e=store.get("auth").token;$.ajax({url:KT.HOST+"/info/service/membership/action/list",method:"GET",headers:{"x-auth-token":e},dataType:"json",contentType:"application/json; charset=UTF-8",success:t.success,error:t.error})}}))}),define("Login",["module","text!tpl/login.html","Model"],function(t,e,n){"use strict";t.exports=new(Backbone.View.extend({el:".login",events:{"click #kt_login_submit":"onSubmit"},render:function(){this.$el.html(e)},onSubmit:function(t){var e=this.$el.find("#kt_login_insert_id").val(),a=this.$el.find("#kt_login_pwd").val();t.preventDefault(),n.postLogin({url:KT.LOGIN_HOST+"/user/login",method:"POST",data:JSON.stringify({username:e,password:a}),dataType:"json",contentType:"application/json; charset=UTF-8",success:Function.prototype.bind.call(this.postLoginSuccess,this),error:Function.prototype.bind.call(this.postLoginError,this)})},postLoginSuccess:function(t,e,n){"success"===e&&store.set("auth",t),window.location.href="#"},postLoginError:function(t,e,n){},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("text!tpl/main.html",[],function(){return'<nav id="kt_topMenu" class="navbar navbar-inverse navbar-fixed-top displayNone"></nav>\n<!-- <div class="kt_dashboard container-fluid" style="margin-top:51px;" ></div>-->\n<div class ="dashboard displayNone">dashboard</div>\n<div id="kt_sub" class="container-fluid"></div>\n'}),define("text!tpl/dashboard.html",[],function(){return'<!-- <h1><a href="#user">USER</a></h1>\n<h1><a href="#menu">MENU</a></h1>\n<h1><a href="#action">ACTION</a></h1> -->\n\n<div style="background-color:#080808;position:relative;padding:30px 0;color:#C4c4FE;font-size:24px;text-align:left;">\n    <div class="container">\n        <h2 style="color:#fff">KT 멤버십 통계 서비스</h2>\n        <p>방문자, 메뉴별, 서비스별로 다양한 통계 데이터와 차트</p>\n    </div>\n</div>\n\n<div class="kt-dashboard-main" style="margin-top:30px;">\n\n    <div class="container">\n        <div class="panel panel-darkred kt-dashboard-user">\n            <div class="panel-heading">\n                <div class="form-inline" style="overflow:hidden;">\n                    <div class="panel-title" style="display: inline-block;">\n                        <a class="small" href="#user"><i class="fa fa-users" aria-hidden="true"></i> 방문자별 (일주일)</a>\n                    </div>\n\n                    <div style="display: inline-block;float:right;">\n                        <a class="btn btn-default btn-xs" href="#user"><strong><i class="fa fa-plus"></i> 더보기</strong></a>\n                    </div>\n                </div>\n            </div>\n            <div class="panel-body">\n                <div class="row">\n                    <div class="col-md-6 user-table">\n                    </div>\n                    <div class="col-md-6">\n                        <div class="user-chart">\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="panel panel-darkred kt-dashboard-menu">\n            <div class="panel-heading">\n                <div class="form-inline" style="overflow:hidden">\n                    <div class="panel-title _m10_r" style="display:inline-block;">\n                        <a class="small" href="#menu"><i class="fa fa-th-list" aria-hidden="true"></i> 메뉴별 (일주일)</a>\n                    </div>\n                    <div style="float:right;">\n                        <a class="btn btn-default btn-xs" href="#menu"><strong><i class="fa fa-plus"></i> 더보기</strong></a>\n                    </div>\n                </div>\n\n            </div>\n            <div class="panel-body">\n                <div class="row">\n                    <div class="col-md-6 menu-table">\n                    </div>\n                    <div class="col-md-6">\n                        <div class="menu-chart"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="panel panel-darkred kt-dashboard-action">\n            <div class="panel-heading">\n                <div class="form-inline" style="overflow:hidden">\n                    <div class="panel-title _m10_r" style="display:inline-block;">\n                        <a class="small" href="#action"><i class="fa fa-check-circle" aria-hidden="true"></i> 서비스별 (일주일)</a>\n                    </div>\n                    <div style="float:right;">\n                        <a class="btn btn-default btn-xs" href="#action"><strong><i class="fa fa-plus"></i> 더보기</strong></a>\n                    </div>\n                </div>\n            </div>\n            <div class="panel-body">\n                <div class="row">\n                    <div class="col-md-6 action-table">\n                    </div>\n                    <div class="col-md-6">\n                        <div class="action-chart"></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n'}),define("text!tpl/tableTemplate.html",[],function(){return'<div>\n    <script class="day-user-list-tpl" type="text/x-handlebars-template">\n    <table class="table table-striped table-bordered" cellspacing="0" width="100%">\n        <thead>\n            <tr>\n                <th>날짜</th>\n                <th>평균체류간</th>\n                <th>고유방문자</th>\n                <th>페이지뷰</th>\n                <th>방문자</th>\n            </tr>\n        </thead>\n        <tbody class="day_user_list">\n            {{#userList}}\n            <tr>\n                <td>{{date}}</td>\n                <td>{{capitalize this.avgVisitTime}}</td>\n                <td>{{numberComma uniqVisits}}</td>\n                <td>{{numberComma pageViews}}</td>\n                <td>{{numberComma visits}}</td>\n            </tr>\n            {{/userList}}\n        </tbody>\n    </table>\n    </script>\n\n    <script class="month_user_list_tpl" type="text/x-handlebars-template">\n    <table class="table table-striped table-bordered" cellspacing="0" width="100%">\n        <thead>\n            <tr>\n                <th>월</th>\n                <th>고유방문자</th>\n                <th>페이지뷰</th>\n                <th>방문자</th>\n            </tr>\n        </thead>\n        <tbody class="day_user_list">\n            {{#userList}}\n            <tr>\n                <td>{{month}}</td>\n                <td>{{numberComma uniqVisits}}</td>\n                <td>{{numberComma pageViews}}</td>\n                <td>{{numberComma visits}}</td>\n            </tr>\n            {{/userList}}\n        </tbody>\n    </table>\n    </script>\n\n    <script class="hour_user_list_tpl" type="text/x-handlebars-template">\n    <table class="table table-striped table-bordered" cellspacing="0" width="100%">\n        <thead>\n            <tr>\n                <th>시간</th>\n                <th>평균고유방문자</th>\n                <th>평균페이지뷰</th>\n                <th>평균방문자</th>\n            </tr>\n        </thead>\n        <tbody class="day_user_list">\n            {{#userList}}\n            <tr>\n                <td>{{hour}}</td>\n                <td>{{numberComma avgUniqVisits}}</td>\n                <td>{{numberComma avgPagesViews}}</td>\n                <td>{{numberComma avgVisits}}</td>\n            </tr>\n            {{/userList}}\n        </tbody>\n    </table>\n    </script>\n\n    <script class="kt-menu-table-tpl" type="text/x-handlebars-template">\n    <table class="table table-striped table-bordered" cellspacing="0" width="100%">\n        <thead>\n            <tr>\n                <th>Date</th>\n                <th>IOS</th>\n                <th>Android</th>\n                <th>Total</th>\n            </tr>\n        </thead>\n        <tbody>\n            {{#list.dataList}}\n            <tr>\n                <td>{{date}}</td>\n                <td>{{numberComma ios}}</td>\n                <td>{{numberComma android}}</td>\n                <td>{{numberComma total}}</td>\n            </tr>\n            {{/list.dataList}}\n        </tbody>\n    </table>\n    </script>\n\n    <script class="kt-action-table-tpl" type="text/x-handlebars-template">\n    <table class="table table-striped table-bordered" cellspacing="0" width="100%">\n        <thead>\n            <tr>\n                <th>Date</th>\n                <th>Android</th>\n                <th>IOS</th>\n            </tr>\n        </thead>\n        <tbody>\n            {{#actionList}}\n            <tr>\n                <td>{{date}}</td>\n                <td>{{numberComma android}}</td>\n                <td>{{numberComma ios}}</td>\n            </tr>\n            {{/actionList}}\n        </tbody>\n    </table>\n    </script>\n\n    <script class="kt-selectbox-tpl" type="text/x-handlebars-template">\n    <select class="form-control {{className}}">\n        {{#list}}\n        <option value="{{name}}">{{name}}</option>\n        {{/list}}\n    </select>\n    </script>\n\n    <script class="kt-dateTimePicker-tpl" type="text/x-handlebars-template">\n    <div class=\'input-group date {{dateTimePickerId}}\'>\n       <input type=\'text\' class="form-control" style="background-color:#fff"/>\n       <span class="input-group-addon">\n           <span class="glyphicon glyphicon-calendar"></span>\n       </span>\n    </div>\n    </script>\n\n</div>\n'}),define("text!tpl/r2_alert.html",[],function(){return'<div class="modal-content">\n    <div class="modal-header">\n        <div class="text-center">\n            <div class="col-md-12">\n                <p style="font-size:18px;margin:0px;">\n                    <i class="fa fa-exclamation-triangle"></i><strong> 알림</strong>\n                </p>\n            </div>\n        </div>\n    </div>\n    <div class="modal-body">\n        <div class="row text-center">\n            <div class="col-md-12">\n                <pre style="margin:0;padding:0;font-size:14px;background-color:#fff;border:none"><strong id="message"></strong></pre>\n            </div>\n        </div>\n    </div>\n    <div class="modal-footer">\n        <div class="text-center">\n            <button class="btn btn-success" id="confirm"><i class="fa fa-check"></i><strong> 확인</strong></button>\n        </div>\n    </div>\n</div>\n'}),define("utils/r2Alert",["module","text!tpl/r2_alert.html"],function(t,e){"use strict";t.exports=new(Backbone.View.extend({title:"",message:"",className:"",callback:null,events:{"click #confirm":"onConfirm"},render:function(t){this.className="r2_alert",console.log(R2.Dialog),t.callback&&(this.callback=t.callback);var n=R2.Dialog.render(this.className,e);this.setElement(n),this.$el.find(".r2-dialog-main").css({width:t.w}),this.$el.find("#message").text(t.msg),R2.Dialog.rePosition(t.className)},onConfirm:function(t){t.preventDefault(),this.callback&&(this.callback(),this.callback=null),R2.Dialog.destroy(this.className)},allDestroy:function(){R2.Dialog.destroy()}}))}),define("text!tpl/r2_loading.html",[],function(){return'<div class="modal-content">\n    <div class="modal-header">\n        <div class="text-center">\n            <div class="r2_loading_img">\n                <img src="dist/img/loading.gif" style="width:20%"></img>\n            </div>\n        </div>\n    </div>\n    <div class="modal-body">\n\n        <div class="row text-center">\n            <!-- <div class="r2_loading_img">\n                <img src="img/loading.gif" style="width:20%"></img>\n            </div> -->\n            <div class="col-md-12">\n                <pre style="margin:0;padding:0;font-size:14px;background-color:#fff;border:none"><strong id="message"></strong></pre>\n            </div>\n        </div>\n    </div>\n</div>\n'}),define("utils/r2Loading",["module","text!tpl/r2_loading.html"],function(t,e){"use strict";t.exports=new(Backbone.View.extend({title:"",message:"",className:"",callback:null,events:{"click #confirm":"onConfirm"},render:function(t){this.className="r2_loading",t.callback&&(this.callback=t.callback);var n=R2.Dialog.render(this.className,e);this.setElement(n),this.$el.find(".r2-dialog-main").css({width:t.w}),this.$el.find("#message").text(t.msg),R2.Dialog.rePosition(t.className)},allDestroy:function(){R2.Dialog.destroy()}}))}),define("Dashboard",["module","text!tpl/dashboard.html","text!tpl/tableTemplate.html","utils/r2Alert","utils/r2Loading","Model"],function(t,e,n,a,i,s){"use strict";t.exports=new(Backbone.View.extend({events:{"change  .kt_area_name_option":"onChangeArea","change  .kt_menu_name_option":"onChangeMenu","change  .kt_action_option":"onChangeAction"},render:function(t){this.setElement(".dashboard"),0===this.$el.children().length&&(this.$el.html(e),this.dayUserListTpl=$(n).find(".day-user-list-tpl").html(),this.menuTableTpl=$(n).find(".kt-menu-table-tpl").html(),this.actionTableTpl=$(n).find(".kt-action-table-tpl").html(),this.selectboxTpl=$(n).find(".kt-selectbox-tpl").html()),this.getUser()},getUser:function(){i.render({msg:"방문자별 데이터를\n불러오는 중입니다.",w:300});var t=moment().format("YYYY-MM-DD"),e=moment.duration(1,"week"),n=moment().subtract(e).format("YYYY-MM-DD");s.getUser({pathDateOption:"daily",fromDate:n,toDate:t,success:Function.prototype.bind.call(this.getUserSuccess,this),error:Function.prototype.bind.call(this.getUserError,this)})},getUserSuccess:function(t,e,n){i.allDestroy(),200===n.status&&"success"===e&&(this.userData=t,this.setUserTable(),this.setUserChart(),this.getMenu())},getUserError:function(t,e,n){if(i.allDestroy(),"error"===e)switch(t.status){case 403:alert("토큰이 만료 되었습니다."),R2.Loading.destroy("r2_loading"),store.remove("auth"),window.location.href="#login";break;case 0:alert("에러가 발생 했습니다."),R2.Loading.destroy("r2_loading"),store.remove("auth"),window.location.href="/"}},setUserTable:function(){var t=Handlebars.compile(this.dayUserListTpl);this.$el.find(".kt-dashboard-user .user-table").html(t({userList:this.userData}))},setUserChart:function(){var t=null,e=["고유방문자"].concat(_.pluck(this.userData,"uniqVisits")),n=["페이지뷰"].concat(_.pluck(this.userData,"pageViews")),a=["방문자"].concat(_.pluck(this.userData,"visits")),i=["x"].concat(_.pluck(this.userData,"date"));t=[i,e,n,a];c3.generate({bindto:".kt-dashboard-user .user-chart",data:{x:"x",columns:t},axis:{x:{type:"category"}}})},getMenu:function(){i.render({msg:"메뉴별 데이터를\n불러오는 중입니다.",w:300});var t=moment().format("YYYY-MM-DD"),e=moment.duration(1,"week"),n=moment().subtract(e).format("YYYY-MM-DD");s.getMenu({fromDate:n,toDate:t,success:Function.prototype.bind.call(this.getMenuSuccess,this),error:Function.prototype.bind.call(this.getMenuError,this)})},getMenuSuccess:function(t,e,n){i.allDestroy(),200===n.status&&"success"===e&&(this.menuData=t.list,this.areaIndex=0,this.menuIndex=0,this.selectMenuData=this.menuData[this.areaIndex].menuList[this.menuIndex],_.each(this.selectMenuData.dataList,function(t){_.extend(t,{total:t.ios+t.android})}),this.setMenuAreaSelectbox(),this.setMenuSelectBox(),this.setMenuTable(),this.setMenuChart(),this.getActionName())},getMenuError:function(t,e,n){if(i.allDestroy(),"error"===e)switch(t.status){case 403:alert("토큰이 만료 되었습니다."),store.remove("auth"),window.location.href="#login";break;case 0:alert("에러가 발생 했습니다."),store.remove("auth"),window.location.href="/"}},setMenuAreaSelectbox:function(){this.areaArr=_.map(this.menuData,function(t,e){return{name:t.area,list:_.map(t.menuList,function(t,e){return{name:t.menuName,index:e}})}});var t=Handlebars.compile(this.selectboxTpl);this.$el.find(".kt-dashboard-menu .panel-title").after(t({className:"kt_area_name_option",list:this.areaArr}))},setMenuSelectBox:function(){this.$el.find(".kt-dashboard-menu .kt_menu_name_option").length>0&&this.$el.find(".kt-dashboard-menu .kt_menu_name_option").remove();var t={className:"kt_menu_name_option",list:this.areaArr[this.areaIndex].list},e=Handlebars.compile(this.selectboxTpl);this.$el.find(".kt-dashboard-menu .kt_area_name_option").after(e(t))},onChangeArea:function(t){this.areaIndex=$(t.currentTarget).find("option").index($(t.currentTarget).find("option:selected")),this.menuIndex=0,this.selectMenuData=this.menuData[this.areaIndex].menuList[this.menuIndex],_.each(this.selectMenuData.dataList,function(t){_.extend(t,{total:t.ios+t.android})}),this.setMenuSelectBox(),this.setMenuTable(),this.setMenuChart()},onChangeMenu:function(t){this.menuIndex=$(t.currentTarget).find("option").index($(t.currentTarget).find("option:selected")),this.selectMenuData=this.menuData[this.areaIndex].menuList[this.menuIndex],_.each(this.selectMenuData.dataList,function(t){_.extend(t,{total:t.ios+t.android})}),this.setMenuTable(),this.setMenuChart()},setMenuTable:function(){this.$el.find(".kt-dashboard-menu .menu-table").children().length>0&&this.$el.find(".kt-dashboard-menu .menu-table").empty();var t=Handlebars.compile(this.menuTableTpl);this.$el.find(".kt-dashboard-menu .menu-table").html(t({list:this.selectMenuData}))},setMenuChart:function(){var t=null,e=["ios"].concat(_.pluck(this.selectMenuData.dataList,"ios")),n=["android"].concat(_.pluck(this.selectMenuData.dataList,"android")),a=["total"].concat(_.pluck(this.selectMenuData.dataList,"total")),i=["x"].concat(_.pluck(this.selectMenuData.dataList,"date"));t=[i,e,n,a];c3.generate({bindto:".kt-dashboard-menu .menu-chart",data:{x:"x",columns:t},axis:{x:{type:"category"}}})},getActionName:function(){i.render({msg:"서비스별 카테고리 데이터\n불러오는 중입니다.",w:300}),s.getActionName({success:Function.prototype.bind.call(this.getActionNameSuccess,this),error:Function.prototype.bind.call(this.getActionNameError,this)})},getActionNameSuccess:function(t,e,n){i.allDestroy(),200===n.status&&"success"===e&&(this.actionName=t[0],this.setActionSelectbox(t),this.getAction())},getActionNameError:function(t,e,n){if(i.allDestroy(),"error"===e)switch(t.status){case 403:alert("토큰이 만료 되었습니다."),store.remove("auth"),window.location.href="#login";break;case 0:alert("에러가 발생 했습니다."),store.remove("auth"),window.location.href="/"}},setActionSelectbox:function(t){var e=_.map(t,function(t){return{name:t}}),n=Handlebars.compile(this.selectboxTpl);this.$el.find(".kt-dashboard-action .panel-title").after(n({className:"kt_action_option",list:e}))},getAction:function(){i.render({msg:"서비스별 데이터를\n불러오는 중입니다.",w:300});var t=moment().format("YYYY-MM-DD"),e=moment.duration(1,"week"),n=moment().subtract(e).format("YYYY-MM-DD");s.getAction({fromDate:n,toDate:t,action:this.actionName,success:Function.prototype.bind.call(this.getActionSuccess,this),error:Function.prototype.bind.call(this.getActionError,this)})},getActionSuccess:function(t,e,n){i.allDestroy(),200===n.status&&"success"===e&&this.setActionData(t)},getActionError:function(t,e,n){if(i.allDestroy(),"error"===e)switch(t.status){case 403:alert("토큰이 만료 되었습니다."),store.remove("auth"),window.location.href="#login";break;case 0:alert("에러가 발생 했습니다."),store.remove("auth"),window.location.href="/"}},setActionData:function(t){var e=_.map(t,function(t,e){return t[t.os]=t.actions,_.omit(t,"actions")}),n=_.uniq(_.map(e,function(t,e){return t.date})),a=[];_.each(n,function(t){var n={action:"",date:"",android:null,ios:null,serviceName:""};_.each(e,function(e){e.date===t&&(null!=e.action&&(n.action=e.action),null!=e.date&&(n.date=e.date),null!=e.android&&(n.android=e.android),null!=e.ios&&(n.ios=e.ios),null!=e.serviceName&&(n.serviceName=e.serviceName))}),a.push(n),n=null}),this.actionData=a,this.setActionTable(),this.setActionChart()},setActionTable:function(){this.$el.find(".kt-dashboard-action .actino-table").empty();var t=Handlebars.compile(this.actionTableTpl);this.$el.find(".kt-dashboard-action .action-table").html(t({actionList:this.actionData}))},setActionChart:function(){var t=null,e=["ios"].concat(_.pluck(this.actionData,"ios")),n=["android"].concat(_.pluck(this.actionData,"android")),a=["x"].concat(_.pluck(this.actionData,"date"));t=[a,e,n];c3.generate({bindto:".kt-dashboard-action .action-chart",data:{x:"x",columns:t},axis:{x:{type:"category"}}})},onChangeAction:function(t){t.preventDefault(),this.actionName=$(t.currentTarget).val(),this.getAction()},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("text!tpl/topMenu.html",[],function(){return'<div class="container-fluid">\n    <div class="navbar-header">\n      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">\n        <span class="sr-only">Toggle navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n      <a class="navbar-brand" href="#"><strong>KT 멤버십 통계</strong></a>\n    </div>\n    <div id="navbar" class="navbar-collapse collapse">\n        <ul class="nav navbar-nav">\n            <li><a href="#user"><strong><i class="fa fa-users" aria-hidden="true"></i> 방문자별</strong></a></li>\n            <li><a href="#menu"><strong><i class="fa fa-th-list" aria-hidden="true"></i> 메뉴별</strong></a></li>\n            <li><a href="#action"><strong><i class="fa fa-check-circle" aria-hidden="true"></i> 서비스별</strong></a></li>\n          </ul>\n      <ul class="nav navbar-nav navbar-right">\n        <li class="kt_info_username" style="margin-right:20px;">\n            <span style="color:#fff;padding-top:15px;padding-bottom:15px;position:relative;display:block;">\n                <i class="fa fa-user"></i>\n                <strong>user2</strong>\n            </span>\n        </li>\n        <li class="kt_info_logout_btn">\n            <a href="#"><i class="fa fa-sign-out text-danger"></i><strong>로그아웃</strong></a>\n        </li>\n      </ul>\n    </div>\n</div>\n'}),define("TopMenu",["module","text!tpl/topMenu.html"],function(t,e){"use strict";t.exports=new(Backbone.View.extend({initialize:function(){},events:{"click .kt_info_logout_btn":"onLogout"},render:function(t){this.setElement("#kt_topMenu"),0===this.$el.children().length&&this.$el.html(e),this.setUserName()},setUserName:function(){var t=store.get("auth").username;this.$el.find(".kt_info_username strong").text(t)},onLogout:function(t){t.preventDefault(),store.remove("auth"),window.location.href="#login"},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("text!tpl/sub.html",[],function(){return'<div class="row">\n    <!-- <div id="kt_leftMenu" class="col-md-2 displayNone">leftMenu</div> -->\n    <div id="kt_user" class="kt_sub_container displayNone col-md-12">user</div>\n    <div id="kt_menu" class="kt_sub_container displayNone col-md-12">menu</div>\n    <div id="kt_action" class="kt_sub_container displayNone col-md-12">menu</div>\n</div>\n'}),define("text!tpl/leftMenu.html",[],function(){return'<ul class="list-group">\n    <li class="list-group-item" style="padding-left:30px"><a href="#user" style="color:#000;">\n        <i class="fa fa-users" aria-hidden="true" style="margin-right:10px;"></i> 방문자 통계</a>\n    </li>\n    <li class="list-group-item" style="padding-left:30px"><a href="#menu" style="color:#000;">\n        <i class="fa fa-th-list" aria-hidden="true" style="margin-right:10px;"></i> 메뉴별 통계</a>\n    </li>\n    <li class="list-group-item" style="padding-left:30px"><a href="#action" style="color:#000;">\n        <i class="fa fa-check-circle" aria-hidden="true" style="margin-right:10px;"></i> 서비스 통계</a>\n    </li>\n</ul>\n'}),define("LeftMenu",["module","text!tpl/leftMenu.html"],function(t,e){"use strict";t.exports=new(Backbone.View.extend({render:function(){this.setElement("#kt_leftMenu"),0===this.$el.children().length&&this.$el.html(e)},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("text!tpl/user.html",[],function(){return'<!--  방문자 검색 부분-->\n<div class="panel panel-default">\n  <div class="panel-body kt_user_option">\n      <div class="row" style="padding-bottom:10px">\n          <label class="col-md-2" style="text-align:right"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i> 검색 구분 : </label>\n          <div class="col-md-10 form-inline">\n              <label class="radio-inline">\n                  <input type="radio" name="dateRadioOption" value="daily" checked> 일별\n              </label>\n              <label class="radio-inline">\n                  <input type="radio" name="dateRadioOption" value="monthly"> 월별\n              </label>\n              <label class="radio-inline">\n                  <input type="radio" name="dateRadioOption" value="hourly"> 시간별\n              </label>\n          </div>\n      </div>\n      <div class="row">\n          <label class="col-md-2" style="text-align:right;padding-top:7px;"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i> 검색 기간 : </label>\n          <div class="col-md-10 form-inline">\n              <button class="btn btn-primary kt_user_serarch_btn"><i class="fa fa-search" aria-hidden="true"></i> <strong>검 색</strong></button>\n          </div>\n      </div>\n  </div>\n</div>\n\n<!--  방문자 테이블과 차트 보기 버튼 -->\n<div class="row" style="margin-bottom:10px;">\n    <div class="col-md-12" style="text-align:right">\n         <button class="btn btn-success kt_user_table_btn" data-type=\'success\'><i class="fa fa-table" aria-hidden="true"></i> <strong>테이블</strong></button>\n         <button class="btn btn-default kt_user_chart_btn" data-type=\'default\'><i class="fa fa-line-chart" aria-hidden="true"></i> <strong>차 트</strong></button>\n    </div>\n</div>\n\n<!--  방문자 차트 부분-->\n<div class="panel panel-default kt_user_chart displayNone">\n  <div class="panel-body">\n        <div class="user_chart"></div>\n    </div>\n</div>\n\n<!--  방문자 테이블 부분-->\n<div class="row kt_user_table">\n    <div class="col-md-12 kt_user_list">\n        <!-- 방문자 테이블 템플릿 html 삽입되는 곳-->\n    </div>\n</div>\n';
}),define("User",["module","text!tpl/user.html","text!tpl/tableTemplate.html","utils/r2Loading","Model"],function(t,e,n,a,i){"use strict";t.exports=new(Backbone.View.extend({dayUserListTpl:"",hourUserListTpl:"",dateTimePickerTpl:"",pathDateOption:"",startDate:"",endDate:"",userData:null,events:{"change .kt_user_option input[name=dateRadioOption]":"onChangeDate","click .kt_user_serarch_btn":"onClickSearch","click .kt_user_table_btn":"onClickHandlerTable","click .kt_user_chart_btn":"onClickHandlerChart"},render:function(){this.setElement("#kt_user"),0===this.$el.children().length&&(this.$el.html(e),this.dayUserListTpl=$(n).find(".day-user-list-tpl").html(),this.hourUserListTpl=$(n).find(".hour_user_list_tpl").html(),this.monthUserListTpl=$(n).find(".month_user_list_tpl").html(),this.dateTimePickerTpl=$(n).find(".kt-dateTimePicker-tpl").html(),this.$el.find(".kt_user_list").empty()),this.pathDateOption=this.$el.find(".kt_user_option input[name=dateRadioOption]:checked").val(),this.startDate=moment().format("YYYY-MM-")+"01",this.endDate=moment().format("YYYY-MM-DD");var t=Handlebars.compile(this.dateTimePickerTpl);this.$el.find(".kt_user_option .kt_user_serarch_btn").before(t({dateTimePickerId:"startDate"})),this.$el.find(".kt_user_option .kt_user_serarch_btn").before(t({dateTimePickerId:"endDate"})),this.$el.find(".endDate").datetimepicker({viewMode:"days",format:"YYYY/MM/DD",defaultDate:"moment",ignoreReadonly:!0}).find('input[type="text"]').attr("readonly",!0),this.$el.find(".startDate").datetimepicker({viewMode:"days",format:"YYYY/MM/DD",defaultDate:moment().format("YYYYMM")+"01",ignoreReadonly:!0}).find('input[type="text"]').attr("readonly",!0),this.getUser(),this.setDateRadioOptions()},getUser:function(){a.render({msg:"방문자별 데이터를\n불러오는 중입니다.",w:300}),i.getUser({pathDateOption:this.pathDateOption,fromDate:this.startDate,toDate:this.endDate,success:Function.prototype.bind.call(this.getUserSuccess,this),error:Function.prototype.bind.call(this.getUserError,this)})},getUserSuccess:function(t,e,n){if(a.allDestroy(),"daily"===this.pathDateOption){this.userData=t;var i=Handlebars.compile(this.dayUserListTpl);this.$el.find(".kt_user_list").html(i({userList:t}))}else if("monthly"===this.pathDateOption){this.userData=t.list;var i=Handlebars.compile(this.monthUserListTpl);this.$el.find(".kt_user_list").html(i({userList:t.list}))}else if("hourly"===this.pathDateOption){this.userData=t.hourData;var i=Handlebars.compile(this.hourUserListTpl);this.$el.find(".kt_user_list").html(i({userList:t.hourData}))}this.$el.find(".kt_user_list table").DataTable({ordering:!1,info:!1,filter:!1,lengthChange:!1,language:{paginate:{first:'<i class="fa fa-angle-double-left" aria-hidden="true"></i> 처음',previous:'<i class="fa fa-angle-left" aria-hidden="true"></i> 이전',next:'다음 <i class="fa fa-angle-right" aria-hidden="true"></i>',last:'마지막 <i class="fa fa-angle-double-right" aria-hidden="true"></i>'}}}),this.setUserChart()},getUserError:function(t,e,n){a.allDestroy(),"error"===e&&403===t.status&&(alert("토큰이 만료 되었습니다."),store.remove("auth"),window.location.href="#login")},onClickHandlerTable:function(t){t.preventDefault();var e=$(t.currentTarget);"default"===e.data("type")?(this.$el.find(".kt_user_table").removeClass("displayNone"),e.data("type","success"),e.removeClass("btn-default").addClass("btn-success")):(this.$el.find(".kt_user_table").addClass("displayNone"),e.data("type","default"),e.removeClass("btn-success").addClass("btn-default"))},onClickHandlerChart:function(t){t.preventDefault();var e=$(t.currentTarget);"default"===e.data("type")?(this.$el.find(".kt_user_chart").removeClass("displayNone"),e.data("type","info"),e.removeClass("btn-default").addClass("btn-info"),this.setUserChart()):(this.$el.find(".kt_user_chart").addClass("displayNone"),e.data("type","default"),e.removeClass("btn-info").addClass("btn-default"))},onClickSearch:function(t){t.preventDefault(),this.$el.find(".kt_user_list").empty();var e=this.$el.find(".kt_user_option .startDate input").val(),n=this.$el.find(".kt_user_option .endDate input").val();this.startDate=e.split("/").join("-"),this.endDate=n.split("/").join("-"),console.log(this.startDate),this.getUser()},setUserChart:function(){console.log(this.userData);var t=null;if("daily"===this.pathDateOption){var e=["고유방문자"].concat(_.pluck(this.userData,"uniqVisits")),n=["페이지뷰"].concat(_.pluck(this.userData,"pageViews")),a=["방문자"].concat(_.pluck(this.userData,"visits")),i=["x"].concat(_.pluck(this.userData,"date"));console.log(i),t=[i,e,n,a]}else if("monthly"===this.pathDateOption){var e=["고유방문자"].concat(_.pluck(this.userData,"uniqVisits")),n=["페이지뷰"].concat(_.pluck(this.userData,"pageViews")),a=["방문자"].concat(_.pluck(this.userData,"visits")),i=["x"].concat(_.pluck(this.userData,"month"));t=[i,e,n,a]}else if("hourly"===this.pathDateOption){var s=["평균페이지뷰"].concat(_.pluck(this.userData,"avgPagesViews")),o=["평균고유방문자"].concat(_.pluck(this.userData,"avgUniqVisits")),l=["평균방문자"].concat(_.pluck(this.userData,"avgVisits")),i=["x"].concat(_.pluck(this.userData,"hour"));t=[i,s,o,l]}console.log(t);c3.generate({bindto:".user_chart",data:{x:"x",columns:t},axis:{x:{type:"category"}}})},onChangeDate:function(t){console.log($(t.currentTarget).val()),this.pathDateOption=$(t.currentTarget).val(),this.$el.find(".kt_user_option .startDate").remove(),this.$el.find(".kt_user_option .endDate").remove();var e=Handlebars.compile(this.dateTimePickerTpl);this.$el.find(".kt_user_option .kt_user_serarch_btn").before(e({dateTimePickerId:"startDate"})),this.$el.find(".kt_user_option .kt_user_serarch_btn").before(e({dateTimePickerId:"endDate"}));var n="",a="",i="";"daily"===this.pathDateOption||"hourly"===this.pathDateOption?(n="days",a="YYYY/MM/DD",i=moment().format("YYYYMM")+"01"):"monthly"===this.pathDateOption&&(n="months",a="YYYY/MM",i="moment"),this.$el.find(".endDate").datetimepicker({viewMode:n,format:a,defaultDate:"moment",ignoreReadonly:!0}),this.$el.find(".startDate").datetimepicker({viewMode:n,format:a,defaultDate:i,ignoreReadonly:!0}),"monthly"===this.pathDateOption&&(this.$el.find("#startDate").on("dp.show",function(t){$(this).data("DateTimePicker").viewMode("months")}),this.$el.find("#endDate").on("dp.show",function(t){$(this).data("DateTimePicker").viewMode("months"),console.log("ksy")}))},setDateRadioOptions:function(){},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("text!tpl/menu.html",[],function(){return'<div class="panel panel-default">\n    <div class="panel-body kt_menu_option">\n        <div class="row ">\n             <label class="col-md-2" style="text-align:right;padding-top:7px;"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i> 검색 기간 : </label>\n            <div class="col-md-10 form-inline">\n                <!--  DateTimePicker import Area -->\n                <button class="btn btn-primary kt_menu_serarch_btn"><i class="fa fa-search" aria-hidden="true"></i> <strong>검 색</strong></button>\n            </div>\n        </div>\n\n    </div>\n</div>\n\n<div class="row" style="margin-bottom:10px;">\n    <div class="col-md-6 form-inline kt_menu_control">\n        <!-- 메뉴별 검색 옵션 템플릿 selectbox 삽입되는 곳-->\n    </div>\n    <div class="col-md-6 form-inline" style="text-align:right;">\n        <button class="btn btn-warning kt_menu_csv_btn" style="margin-right:5px;">기간내 전체 CSV 파일 내보내기</button>\n        <button class="btn btn-success kt_menu_table_btn" data-type="success"><i class="fa fa-table" aria-hidden="true"></i> <strong>테이블</strong></button>\n        <button class="btn btn-default kt_menu_chart_btn" data-type="default"><i class="fa fa-line-chart" aria-hidden="true"></i> <strong>차 트</strong></button>\n    </div>\n</div>\n\n<!--  메뉴별 차트 부분-->\n<div class="panel panel-default kt_menu_chart displayNone">\n  <div class="panel-body">\n        <div class="menu_chart"></div>\n    </div>\n</div>\n\n<div class="row kt_menu_table">\n    <div class="col-md-12 kt_menu_list">\n        <!-- 메뉴별 테이블 템플릿 html 삽입되는 곳-->\n    </div>\n</div>\n'}),define("Menu",["module","text!tpl/menu.html","text!tpl/tableTemplate.html","utils/r2Loading","Model"],function(t,e,n,a,i){"use strict";t.exports=new(Backbone.View.extend({dateTimePickerTpl:"",selectboxTpl:"",menuListTpl:"",areaArr:null,areaIndex:0,menuIndex:0,menuData:null,events:{"click .kt_menu_csv_btn":"onCVSClickHanlder","click .kt_menu_serarch_btn":"onSearchHanlder","change  .kt_area_name_option":"onChangeArea","change  .kt_menu_name_option":"onChangeMenu","click .kt_menu_table_btn":"onClickHandlerTable","click .kt_menu_chart_btn":"onClickHandlerChart"},render:function(){this.setElement("#kt_menu"),0===this.$el.children().length&&(this.$el.html(e),this.selectboxTpl=$(n).find(".kt-selectbox-tpl").html(),this.menuTableTpl=$(n).find(".kt-menu-table-tpl").html(),this.dateTimePickerTpl=$(n).find(".kt-dateTimePicker-tpl").html()),this.$el.find("#example").DataTable({ordering:!1,info:!1,filter:!1,lengthChange:!1}),this.setDateTimePicker(),this.onSearchHanlder(null)},onClickHandlerTable:function(t){t.preventDefault();var e=$(t.currentTarget);"default"===e.data("type")?(this.$el.find(".kt_menu_table").removeClass("displayNone"),e.data("type","success"),e.removeClass("btn-default").addClass("btn-success")):(this.$el.find(".kt_menu_table").addClass("displayNone"),e.data("type","default"),e.removeClass("btn-success").addClass("btn-default"))},onClickHandlerChart:function(t){t.preventDefault();var e=$(t.currentTarget);"default"===e.data("type")?(this.$el.find(".kt_menu_chart").removeClass("displayNone"),e.data("type","info"),e.removeClass("btn-default").addClass("btn-info"),this.setMenuChart()):(this.$el.find(".kt_menu_chart").addClass("displayNone"),e.data("type","default"),e.removeClass("btn-info").addClass("btn-default"))},onSearchHanlder:function(t){a.render({msg:"메뉴별 데이터를\n불러오는 중입니다.",w:300}),this.getMenu()},setDateTimePicker:function(){var t=Handlebars.compile(this.dateTimePickerTpl);this.$el.find(".kt_menu_option .kt_menu_serarch_btn").before(t({dateTimePickerId:"startDate"})),this.$el.find(".kt_menu_option .kt_menu_serarch_btn").before(t({dateTimePickerId:"endDate"}));var e={viewMode:"days",format:"YYYY-MM-DD",ignoreReadonly:!0};this.$el.find(".startDate").datetimepicker(_.extend(e,{defaultDate:this.getStartDate()})),this.$el.find(".endDate").datetimepicker(_.extend(e,{defaultDate:this.getEndDate()}))},getStartDate:function(){var t=this.$el.find(".kt_menu_option .startDate input").val();return""===t?moment().format("YYYY-MM-")+"01":t},getEndDate:function(){var t=this.$el.find(".kt_menu_option .endDate input").val();return""===t?moment().format("YYYY-MM-DD"):t},getMenu:function(){i.getMenu({fromDate:this.getStartDate(),toDate:this.getEndDate(),success:Function.prototype.bind.call(this.getMenuSuccess,this),error:Function.prototype.bind.call(this.getMenuError,this)})},getMenuSuccess:function(t,e,n){a.allDestroy(),console.log(t),this.menuData=t.list,this.areaIndex=0,this.menuIndex=0,this.setAreaSelectBox(t),this.setMenuList()},getMenuError:function(t,e,n){a.allDestroy(),console.log(t),console.log(e),console.log(n),"error"===e&&403===t.status&&(alert("토큰이 만료 되었습니다."),store.remove("auth"),window.location.href="#login")},setAreaSelectBox:function(t){this.areaArr=_.map(t.list,function(t,e){return{name:t.area,list:_.map(t.menuList,function(t,e){return{name:t.menuName,index:e}})}}),this.$el.find(".kt_area_name_option").length>0&&this.$el.find(".kt_area_name_option").remove();var e=Handlebars.compile(this.selectboxTpl);this.$el.find(".kt_menu_control").append(e({className:"kt_area_name_option",list:this.areaArr})),this.setMenuSelectBox(this.areaIndex)},setMenuSelectBox:function(t){this.$el.find(".kt_menu_name_option").length>0&&this.$el.find(".kt_menu_name_option").remove();var e={className:"kt_menu_name_option",list:this.areaArr[t].list},n=Handlebars.compile(this.selectboxTpl);this.$el.find(".kt_menu_control").append(n(e))},setMenuImage:function(){this.$el.find(".kt_menu_control .kt_menu_image").remove(),""!==this.menuData[this.areaIndex].menuList[this.menuIndex].image&&this.$el.find(".kt_menu_control").append('<img class="kt_menu_image" src="'+this.menuData[this.areaIndex].menuList[this.menuIndex].image+'" style="width:100px;"/>')},setMenuChart:function(){console.log(this.menuData[this.areaIndex].menuList[this.menuIndex]);var t=null,e=["ios"].concat(_.pluck(this.menuData[this.areaIndex].menuList[this.menuIndex].dataList,"ios")),n=["android"].concat(_.pluck(this.menuData[this.areaIndex].menuList[this.menuIndex].dataList,"android")),a=["x"].concat(_.pluck(this.menuData[this.areaIndex].menuList[this.menuIndex].dataList,"date"));t=[a,e,n],console.log(t),console.log("1212");c3.generate({bindto:".menu_chart",data:{x:"x",columns:t},axis:{x:{type:"category"}}})},onChangeArea:function(t){this.areaIndex=$(t.currentTarget).find("option").index($(t.currentTarget).find("option:selected")),this.menuIndex=0,this.setMenuSelectBox(this.areaIndex),this.setMenuList()},onChangeMenu:function(t){this.menuIndex=$(t.currentTarget).find("option").index($(t.currentTarget).find("option:selected")),this.setMenuList()},setMenuList:function(){this.setMenuImage(),this.setMenuChart(),console.log(this.$el.find(".kt_menu_list").children().length),this.$el.find(".kt_menu_list").children().length>0&&this.$el.find(".kt_menu_list").empty();var t=this.menuData[this.areaIndex].menuList[this.menuIndex];_.each(t.dataList,function(t){_.extend(t,{total:t.ios+t.android})});var e=Handlebars.compile(this.menuTableTpl);this.$el.find(".kt_menu_list").html(e({list:t})),this.$el.find(".kt_menu_table table").DataTable({ordering:!1,info:!1,filter:!1,lengthChange:!1,language:{paginate:{first:'<i class="fa fa-angle-double-left" aria-hidden="true"></i> 처음',previous:'<i class="fa fa-angle-left" aria-hidden="true"></i> 이전',next:'다음 <i class="fa fa-angle-right" aria-hidden="true"></i>',last:'마지막 <i class="fa fa-angle-double-right" aria-hidden="true"></i>'}}})},onCVSClickHanlder:function(){console.log(this.menuData);var t=[];_.each(this.menuData,function(e){_.each(e.menuList,function(e){_.each(e.dataList,function(e){t.push(e.date)})})});var e=_.union(t);console.log(e);var n=[];_.each(this.menuData,function(a){_.each(a.menuList,function(a){var i={};i["페이지명"]=a.menuName,_.each(a.dataList,function(n){t.push(n.date),_.each(e,function(t){t===n.date?i[t]=n.android+n.ios:i[t]=0})}),n.push(i),i=null})}),console.log(n);this.test(n,"메뉴별 통계",!0)},test:function(t,e,n){var a="object"!=typeof t?JSON.parse(t):t,i="";if(i+=e+"\r\n\n",n){var s="";for(var o in a[0])s+=o+",";s=s.slice(0,-1),i+=s+"\r\n"}for(var l=0;l<a.length;l++){var s="";for(var o in a[l])s+='"'+a[l][o]+'",';s.slice(0,s.length-1),i+=s+"\r\n"}if(""==i)return void alert("Invalid data");var r="MyReport_";r+=e.replace(/ /g,"_");var d="data:text/csv;charset=UTF-8,\ufeff"+encodeURI(i),c=document.createElement("a");c.href=d,c.style="visibility:hidden",c.download=r+".csv",document.body.appendChild(c),c.click(),document.body.removeChild(c)},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("text!tpl/action.html",[],function(){return'\n\n<div class="panel panel-default">\n    <div class="panel-body kt_action_option">\n        <div class="row" style="margin-bottom:10px;">\n            <label class="col-md-2" style="text-align:right;padding-top:7px;"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i> 검색 구분 : </label>\n            <div class="col-md-10 form-inline kt_action_name">\n            </div>\n        </div>\n        <div class="row">\n            <label class="col-md-2" style="text-align:right;padding-top:7px;"><i class="fa fa-chevron-circle-right" aria-hidden="true"></i> 검색 기간 : </label>\n            <div class="col-md-10 form-inline ">\n                <button class="btn btn-primary kt_action_serarch_btn"><i class="fa fa-search" aria-hidden="true"></i> <strong>검 색</strong></button>\n\n            </div>\n        </div>\n\n    </div>\n</div>\n\n\n<!--  서비스별 테이블과 차트 보기 버튼 -->\n<div class="row" style="margin-bottom:10px;">\n    <div class="col-md-12" style="text-align:right">\n         <button class="btn btn-success kt_action_table_btn" data-type=\'success\'><i class="fa fa-table" aria-hidden="true"></i> <strong>테이블</strong></button>\n         <button class="btn btn-default kt_action_chart_btn" data-type=\'default\'><i class="fa fa-line-chart" aria-hidden="true"></i> <strong>차 트</strong></button>\n    </div>\n</div>\n\n<!--  서비스별 차트 부분-->\n<div class="panel panel-default kt_action_chart displayNone">\n  <div class="panel-body">\n        <div class="action_chart"></div>\n    </div>\n</div>\n\n<!--  서비스별 테이블 부분-->\n<div class="row kt_action_table">\n    <div class="col-md-12 kt_action_list">\n        <script class="action_list_tpl" type="text/x-handlebars-template">\n        <table id="actionListTable" class="table table-striped table-bordered" cellspacing="0" width="100%">\n            <thead>\n                <tr>\n                    <th>Date</th>\n                    <th>Android</th>\n                    <th>IOS</th>\n                </tr>\n            </thead>\n            <tbody>\n                {{#actionList}}\n                <tr>\n                    <td>{{date}}</td>\n                    <td>{{android}}</td>\n                    <td>{{ios}}</td>\n                </tr>\n                {{/actionList}}\n            </tbody>\n        </table>\n        </script>\n    </div>\n</div>\n'}),define("Action",["module","text!tpl/action.html","text!tpl/tableTemplate.html","utils/r2Loading","Model"],function(t,e,n,a,i){"use strict";t.exports=new(Backbone.View.extend({actionListTpl:"",selectboxTpl:"",actionName:"",startDate:"",endDate:"",actionData:"",events:{"change .kt_action_option .kt_action_option":"onChangeAction","click .kt_action_serarch_btn":"onClickSearch","click .kt_action_table_btn":"onClickHandlerTable","click .kt_action_chart_btn":"onClickHandlerChart"},render:function(){this.setElement("#kt_action"),0===this.$el.children().length&&(this.$el.html(e),this.selectboxTpl=$(n).find(".kt-selectbox-tpl").html(),this.actionListTpl=$(n).find(".kt-action-table-tpl").html(),this.dateTimePickerTpl=$(n).find(".kt-dateTimePicker-tpl").html()),this.startDate=moment().format("YYYY-MM-")+"01",this.endDate=moment().format("YYYY-MM-DD");var t=Handlebars.compile(this.dateTimePickerTpl);this.$el.find(".kt_action_option .kt_action_serarch_btn").before(t({dateTimePickerId:"startDate"})),this.$el.find(".kt_action_option .kt_action_serarch_btn").before(t({dateTimePickerId:"endDate"})),this.$el.find(".endDate").datetimepicker({viewMode:"days",format:"YYYY/MM/DD",defaultDate:"moment",ignoreReadonly:!0}).find('input[type="text"]').attr("readonly",!0),this.$el.find(".startDate").datetimepicker({viewMode:"days",format:"YYYY/MM/DD",defaultDate:moment().format("YYYYMM")+"01",ignoreReadonly:!0}).find('input[type="text"]').attr("readonly",!0),this.getActionName()},onClickHandlerTable:function(t){t.preventDefault();var e=$(t.currentTarget);"default"===e.data("type")?(this.$el.find(".kt_action_table").removeClass("displayNone"),e.data("type","success"),e.removeClass("btn-default").addClass("btn-success")):(this.$el.find(".kt_action_table").addClass("displayNone"),e.data("type","default"),e.removeClass("btn-success").addClass("btn-default"))},onClickHandlerChart:function(t){t.preventDefault();var e=$(t.currentTarget);"default"===e.data("type")?(this.$el.find(".kt_action_chart").removeClass("displayNone"),e.data("type","info"),e.removeClass("btn-default").addClass("btn-info"),this.setActionChart()):(this.$el.find(".kt_action_chart").addClass("displayNone"),e.data("type","default"),e.removeClass("btn-info").addClass("btn-default"))},setActionChart:function(){console.log(this.actionData);var t=null,e=["ios"].concat(_.pluck(this.actionData,"ios")),n=["android"].concat(_.pluck(this.actionData,"android")),a=["x"].concat(_.pluck(this.actionData,"date"));t=[a,e,n];c3.generate({bindto:".action_chart",data:{x:"x",columns:t},axis:{x:{type:"category"}}})},onChangeAction:function(t){this.actionName=$(t.currentTarget).val()},onClickSearch:function(t){t.preventDefault(),this.$el.find(".kt_action_list").empty();var e=this.$el.find(".kt_action_option .startDate input").val(),n=this.$el.find(".kt_action_option .endDate input").val();this.startDate=e.split("/").join("-"),this.endDate=n.split("/").join("-"),this.getAction()},getActionName:function(){a.render({msg:"서비스별 카테고리 데이터를\n불러오는 중입니다.",w:300}),i.getActionName({success:Function.prototype.bind.call(this.getActionNameSuccess,this),error:Function.prototype.bind.call(this.getActionNameError,this)})},getActionNameSuccess:function(t,e,n){a.allDestroy(),200===n.status&&"success"===e&&(this.actionName=t[0],this.setActionSelectbox(t),this.getAction())},setActionSelectbox:function(t){var e=_.map(t,function(t){return{name:t}}),n=Handlebars.compile(this.selectboxTpl);this.$el.find(".kt_action_name").html(n({className:"kt_action_option",list:e}))},getActionNameError:function(t,e,n){a.allDestroy(),"error"===e&&403===t.status&&(alert("토큰이 만료 되었습니다."),store.remove("auth"),window.location.href="#login")},getAction:function(){a.render({msg:"서비스별 데이터를\n불러오는 중입니다.",w:300}),i.getAction({fromDate:this.startDate,toDate:this.endDate,action:this.actionName,success:Function.prototype.bind.call(this.getActionSuccess,this),error:Function.prototype.bind.call(this.getActionError,this)})},getActionSuccess:function(t,e,n){a.allDestroy();var i=_.map(t,function(t,e){return t[t.os]=t.actions,_.omit(t,"actions")}),s=_.uniq(_.map(i,function(t,e){return t.date}));console.log(s);var o=[];_.each(s,function(t){var e={action:"",date:"",android:null,ios:null,serviceName:""};_.each(i,function(n){n.date===t&&(null!=n.action&&(e.action=n.action),null!=n.date&&(e.date=n.date),null!=n.android&&(e.android=n.android),null!=n.ios&&(e.ios=n.ios),null!=n.serviceName&&(e.serviceName=n.serviceName))}),o.push(e),e=null}),this.actionData=o,console.log(o),this.$el.find(".kt_action_list tbody").empty();var l=Handlebars.compile(this.actionListTpl);this.$el.find(".kt_action_list").append(l({actionList:o})),this.$el.find(".kt_action_table table").DataTable({ordering:!1,info:!1,filter:!1,lengthChange:!1,language:{paginate:{first:'<i class="fa fa-angle-double-left" aria-hidden="true"></i> 처음',previous:'<i class="fa fa-angle-left" aria-hidden="true"></i> 이전',next:'다음 <i class="fa fa-angle-right" aria-hidden="true"></i>',last:'마지막 <i class="fa fa-angle-double-right" aria-hidden="true"></i>'}}}),this.setActionChart()},getActionError:function(t,e,n){a.allDestroy(),"error"===e&&403===t.status&&(alert("토큰이 만료 되었습니다."),store.remove("auth"),window.location.href="#login")},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("Sub",["module","text!tpl/sub.html","LeftMenu","User","Menu","Action"],function(t,e,n,a,i,s){"use strict";t.exports=new(Backbone.View.extend({prevView:null,render:function(t){switch(this.setElement("#kt_sub"),this.$el.html(e),null!=this.prevView&&this.prevView.hide(),console.log("1212"),n.render(),n.show(),t){case"user":a.render(),this.prevView=a,a.show();break;case"menu":i.render(),this.prevView=i,i.show();break;case"action":s.render(),this.prevView=s,s.show()}},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),define("Main",["module","text!tpl/main.html","Dashboard","TopMenu","Sub"],function(t,e,n,a,i){"use strict";t.exports=new(Backbone.View.extend({el:".main",prevView:null,initialize:function(){},render:function(t){switch(this.$el.html(e),null!=this.prevView&&this.prevView.hide(),console.log("여기"),a.render(),a.show(),t){case"user":case"menu":case"action":i.render(t),this.prevView=i,i.show();break;default:n.render(),this.prevView=n,n.show()}},hide:function(){this.$el.addClass("displayNone")},show:function(){this.$el.removeClass("displayNone")}}))}),requirejs.config({baseUrl:"/js",paths:{text:"../lib/text/text",tpl:"../template"}}),requirejs(["Login","Main","Dashboard"],function(t,e,n){function a(){Handlebars.registerHelper("capitalize",function(t){return KT.util.millisecondToTime(parseInt(t,10))}),Handlebars.registerHelper("numberComma",function(t){return numeral(parseInt(t,10)).format("0,0")});var t=KT.util.parseHash();console.log("1234"),i(),t?l.navigate(t.join("/"),{trigger:!1,replace:!0}):l.navigate("",{trigger:!0,replace:!0})}function i(){window.router=l=new(Backbone.Router.extend()),l.route("","defaultGuide",s),l.route("*guideType","changeGuide",s),l.route("*guideType/:main","changeMainMenu",s),l.route("*guideType/:main/:sub","changeSubMenu",s),Backbone.history.start({pushstate:!0})}function s(n,a,i){if((null===KT.util.parseHash()||"login"!==KT.util.parseHash()[0])&&void 0===store.get("auth"))return void(window.location.href="#login");null!=o&&o.hide();var s=n;switch(s){case"login":$("body").css({"background-color":"#2D3E4F"}),t.render(),o=t,t.show();break;case"user":case"menu":case"action":case null:$("body").css({"background-color":"#FFFFFF"}),e.render(s),o=e,e.show();break;default:window.location.href="/"}}var o=null,l=null;a()}),define("App",function(){});